{% extends 'base.html' %}
{% load static app_extras %}

{% block title %}Oils Trades{% endblock %}

{% block css_block %}
    <!-- core:css -->
    <link rel="stylesheet" href="{% static "vendors/core/core.css" %}">
    <!-- endinject -->
    <!-- plugin css for this page -->
{#    <link rel="stylesheet" href="{% static "vendors/select2/select2.min.css" %}">#}
{#    <link rel="stylesheet" href="{% static "vendors/jquery-tags-input/jquery.tagsinput.min.css" %}">#}
{#    <link rel="stylesheet" href="{% static "vendors/dropzone/dropzone.min.css" %}">#}
{#    <link rel="stylesheet" href="{% static "vendors/dropify/dist/dropify.min.css" %}">#}
{#    <link rel="stylesheet" href="{% static "vendors/bootstrap-colorpicker/bootstrap-colorpicker.min.css" %}">#}
    <link rel="stylesheet" href="{% static "vendors/bootstrap-datepicker/bootstrap-datepicker.min.css" %}">
    <link rel="stylesheet" href="{% static "vendors/font-awesome/css/font-awesome.min.css" %}">
    <link rel="stylesheet" href="{% static "vendors/tempusdominus-bootstrap-4/tempusdominus-bootstrap-4.min.css" %}">
    <link rel="stylesheet" href="{% static "vendors/datatables.net-bs4/dataTables.bootstrap4.css" %}">
    <!-- end plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="{% static "fonts/feather-font/css/iconfont.css" %}">
    <link rel="stylesheet" href="{% static "vendors/flag-icon-css/css/flag-icon.min.css" %}">
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static "css/demo_1/style.css" %}">
    <!-- End layout styles -->
{% endblock %}

{% block body_content %}
    <div class="page-content">

        <nav class="page-breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Forms</a></li>
                <li class="breadcrumb-item active" aria-current="page">Oil Trades</li>
            </ol>
        </nav>

        <div class="row">
            <div class="col-md-12 grid-margin">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">Add New Oil Trade</h6>
                        <form action="{% url 'oil_trades_add' %}" method="post">
                            {% csrf_token %}
                            {{ form.non_field_errors }}
                            <div class="row">
                                <div class="col-sm-7">
                                    <div class="form-group">
                                        <label>Oil</label>
                                        <div id="the-basics">
                                            <input value="{{ form|get_item:'oil' }}" name="oil" required="required" class="typeahead" type="text" placeholder="Oil Name">
                                        </div>
                                    </div>
                                </div><!-- Col -->
                                <div class="col-sm-5">
                                    <div class="form-group">
                                        <label class="control-label">Litres Sold</label>
                                        <input name="litreSold" required="required" type="number" class="form-control" placeholder="Enter in Integers">
                                    </div>
                                </div><!-- Col -->
                            </div><!-- Row -->
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label">Date</label>
                                        <div class="input-group date datepicker" id="datePickerExample">
                                            <input name="dateTime_0" type="text" class="form-control"><span class="input-group-addon"><i data-feather="calendar"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label">Time</label>
                                        <div class="input-group date timepicker" id="datetimepickerExample" data-target-input="nearest">
                                            <input name="dateTime_1" type="text" required="required" class="form-control datetimepicker-input" data-target="#datetimepickerExample"/>
                                            <div class="input-group-append" data-target="#datetimepickerExample" data-toggle="datetimepicker">
                                                <div class="input-group-text"><i data-feather="clock"></i></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div><!-- Row -->
                            <button type="submit" class="btn btn-primary submit">Submit form</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">Oil Trades</h6>
                        <div class="table-responsive">
                            <table id="dataTableExample" class="table">
                                <thead>
                                <tr>
                                    <th>Oil</th>
                                    <th>Litre Sold</th>
                                    <th>Trade Price</th>
                                    <th>Time</th>
                                    <th>Edit / Delete</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for trade in oilTrades %}
                                    <tr>
                                        <td>{{ trade.oil }}</td>
                                        <td>{{ trade.litreSold|floatformat:1 }} L</td>
                                        <td>{{ trade.tradePrice|floatformat:2 }} UZS</td>
                                        <td>{{ trade.dateTime|date:"Y.m.d H:i" }}</td>
                                        <td><a href="#" class="editor_edit">Edit</a> / <a href="{% url 'oil_trades_delete' %}"
                                                                                          title="{{ trade.pk }}"
                                                                                          id="Delete{{ forloop.counter }}"
                                                                                          class="editor_remove">Delete</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
{% endblock %}

{% block scripts_block %}
    <!-- core:js -->
    <script src="{% static "vendors/core/core.js" %}"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="{% static "vendors/jquery-validation/jquery.validate.min.js" %}"></script>
    <script src="{% static "vendors/bootstrap-maxlength/bootstrap-maxlength.min.js" %}"></script>
    <script src="{% static "vendors/inputmask/jquery.inputmask.min.js" %}"></script>
    <script src="{% static "vendors/select2/select2.min-2.js" %}"></script>
    <script src="{% static "vendors/typeahead.js/typeahead.bundle.min.js" %}"></script>
    <script src="{% static "vendors/jquery-tags-input/jquery.tagsinput.min.js" %}"></script>
    <script src="{% static "vendors/dropzone/dropzone.min.js" %}"></script>
    <script src="{% static "vendors/dropify/dist/dropify.min.js" %}"></script>
    <script src="{% static "vendors/bootstrap-colorpicker/bootstrap-colorpicker.min.js" %}"></script>
    <script src="{% static "vendors/bootstrap-datepicker/bootstrap-datepicker.min.js" %}"></script>
    <script src="{% static "vendors/moment/moment.min.js" %}"></script>
    <script src="{% static "vendors/tempusdominus-bootstrap-4/tempusdominus-bootstrap-4.js" %}"></script>
    <!-- end plugin js for this page -->
    <!-- inject:js -->
    <script src="{% static "vendors/feather-icons/feather.min.js" %}"></script>
    <script src="{% static "js/template.js" %}"></script>
    <!-- endinject -->
    <!-- custom js for this page -->
    <script src="{% static "js/form-validation.js" %}"></script>
    <script src="{% static "js/bootstrap-maxlength.js" %}"></script>
    <script src="{% static "js/inputmask.js" %}"></script>
    <script src="{% static "js/select2.js" %}"></script>
    <script src="{% static "js/typeahead.js" %}"></script>
    <script src="{% static "js/tags-input.js" %}"></script>
{#    <script src="{% static "js/dropzone.js" %}"></script>#}
{#    <script src="{% static "js/dropify.js" %}"></script>#}
    <script src="{% static "js/bootstrap-colorpicker.js" %}"></script>
    <script src="{% static "js/datepicker.js" %}"></script>
    <script src="{% static "js/timepicker.js" %}"></script>

    <script src="{% static "vendors/datatables.net/jquery.dataTables.js" %}"></script>
    <script src="{% static "vendors/datatables.net-bs4/dataTables.bootstrap4.js" %}"></script>
    <script src="{% static "vendors/js-coockie/js.cookie.min.js" %}"></script>
    <script src="{% static "js/data-table.js" %}"></script>
    <script>
      var substringMatcher = function(strs) {
        return function findMatches(q, cb) {
          var matches, substringRegex;

          // an array that will be populated with substring matches
          matches = [];

          // regex used to determine if a string contains the substring `q`
          var substrRegex = new RegExp(q, 'i');

          // iterate through the pool of strings and for any string that
          // contains the substring `q`, add it to the `matches` array
          for (var i = 0; i < strs.length; i++) {
            if (substrRegex.test(strs[i])) {
              matches.push(strs[i]);
            }
          }

          cb(matches);
        };
      };
      var states = [
          {% for oil in oils %}
              "{{ oil.name }}"
              {% if not forloop.last %},{% endif %}
          {% endfor %}
      ];

      $('#the-basics .typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1
      }, {
        name: 'states',
        source: substringMatcher(states)
      });
    </script>
    <!-- end custom js for this page -->
{% endblock %}

